@using EventCombo.Models
@model EventInfoViewModel
@{
  Layout = "~/Views/Shared/_AngularLayout.cshtml";
}

@section CSSSection
{
  @Styles.Render("~/Content/AngularViewEvent")
}

@section ScriptSection
{
  @Scripts.Render("~/Scripts/AMaterial/viewEvent")
}

@section ScriptFooterSection
{
  @Scripts.Render("~/Scripts/AMaterial/viewEventFooter")
  <script type="text/javascript">
    function addToCartMap(e, id) {
      angular.element(document.getElementById('addDealMap')).scope().addToCartMap(id);
    }
  </script>
}

<div class="c6 buttons padding-1em-top padding-1em-bottom text-right hide768">
  <a href="#" class="makeLive">Get Tickets</a>
</div>

<section class="eventBanner" style="@((!String.IsNullOrEmpty(Model.BackgroundUrl) ? "background-image:url(" + Model.BackgroundUrl + ");" : "") +
(!String.IsNullOrEmpty(Model.BackgroundColor) ? "background-color:" + Model.BackgroundColor : ""))">
  <div class="grid w960">
    <div class="row">
      <div class="c12 eventVanue">
        <h2 class="event-name">@Model.EventTitle</h2>
        <h3 class="vanue-name">@Model.VenueName</h3>
        <div class="adiv"><i class="material-icons black">location_on</i>@Model.Address</div>
        <div class="adiv"><i class="material-icons">schedule</i> ---Friday, February 10, 2016 8:30 PM</div>
        <div class="adiv"><i class="material-icons invisible">attach_money</i> ----$10 - $300</div>
        <div class="wgts">
          <span><a href="#" title="Add EventTitle to your favorites"><i class="material-icons">favorite</i></a> 12K</span>
          <span><a href="#" title="Vote for EventTitle"><i class="material-icons">thumb_up</i></a> 876</span>
          <span class="social" social="SHARE THIS">
            <a href="#" title="Email"><img width="20px" alt="Email" src="~/Images/AMaterial/mail-square.svg"></a>
            <a href="#" title="Facebook"><img width="20px" alt="Facebook" src="~/Images/AMaterial/square-facebook.svg"></a>
            <a href="#" title="Twitter"><img width="20px" alt="Twitter" src="~/Images/AMaterial/square-twitter.svg"></a>
            <a href="#" title="LinkedIn"><img width="20px" alt="LinkedIn" src="~/Images/AMaterial/square-linkedin.svg"></a>
            <a href="#" title="FB Messenger"><img width="20px" alt="FB Messenger" src="~/Images/AMaterial/fb_messenger.svg"></a>
          </span>
        </div>
      </div>
    </div>
  </div>
</section>
<!--****************************************************************************************************************************-->
<article class="grid w960">
  <div class="row">
    <div class="c10 s1">
      <ul class="text-links">
        <li><a href="~/et/@(Model.EventTypeId.ToString())/evc/ALL/page/lat/long/rel/none">#@Model.EventType</a></li>
        <li><a href="~/et/evt/@(Model.EventCategoryId.ToString())/ALL/page/lat/long/rel/none">#@Model.EventCategory</a></li>
        <li>#@Model.EventSubCategory</li>
      </ul>
      <a href="#" class="eventFlyer" title="@Model.ImageAlt"><img src="@Model.ImageUrl" alt="@Model.ImageAlt"></a>
      <p class="eventFlyerDes">@Html.Raw(Model.EventDescription)</p>
      <div class="saroosh">
        @if (!String.IsNullOrEmpty(Model.Organizer.ImageUrl))
        {
          <img src="@Model.Organizer.ImageUrl" alt="@Model.Organizer.OrganizerName">
        }
        <div>
          <p>
            @Model.Organizer.OrganizerName<br>
            @if (!String.IsNullOrEmpty(Model.Organizer.WebsiteUrl))
            {
              <a title="@Model.Organizer.WebsiteUrl" href="@Model.Organizer.WebsiteUrl" target="_blank">@Model.Organizer.WebsiteUrl</a>
            }
          </p>
        </div>
        <div>
          <span><a href="#">Contact</a></span>
          <span><a href="#">Profile</a></span>
          <span class="social">
            @if (!String.IsNullOrEmpty(Model.Organizer.FBLink))
            {
              <a href="@Model.Organizer.FBLink"><img width="20px" alt="Facebook" src="images/square-facebook.svg"></a>

            }
            @if (!String.IsNullOrEmpty(Model.Organizer.TwitterLink))
            {
              <a href="@Model.Organizer.TwitterLink"><img width="20px" alt="Twitter" src="images/square-twitter.svg"></a>
            }
            @if (!String.IsNullOrEmpty(Model.Organizer.LinkdeInLink))
            {
              <a href="@Model.Organizer.LinkdeInLink"><img width="20px" alt="LinkedIn" src="images/square-linkedin.svg"></a>
            }
          </span>
        </div>
      </div>
    </div>
  </div>
</article>
<!--****************************************************************************************************************************-->
<section class="grid wfull" ng-controller="gallery as tCtrl">
  <div id="owlCarousel">
    <img ng-repeat="i in images" ng-repeat-owl-carousel carousel-init="carouselInitializer" ng-src="{{ i.thumb }}" alt="{{ i.title }}" ng-click="showAdvanced($event, i.id)">
  </div>
</section>
<!--****************************************************************************************************************************-->
<script type="text/ng-template" id="dialog1.tmpl.html">
  <md-dialog aria-label="Image Title" ng-cloak>
    <md-toolbar>
      <div class="md-toolbar-tools">
        <h2>Image Gallery</h2>
        <span flex></span>
        <md-button class="md-icon-button" ng-click="cancel()">
          <i class="material-icons">clear</i>
        </md-button>
      </div>
    </md-toolbar>

    <md-dialog-content>
      <div class="md-dialog-content">
        <img ng-repeat="i in images" ng-if="i.id>=image.id" ng-src="{{ i.img }}" alt="{{ i.title }}" tabindex="0">
        <img ng-repeat="i in images" ng-if="i.id<image.id" ng-src="{{ i.img }}" alt="{{ i.title }}" tabindex="0">
      </div>
    </md-dialog-content>
  </md-dialog>
</script>
<!--****************************************************************************************************************************-->
<section class="grid w960">
  <div class="row">
    <div class="c12 margin-1em-bottom">
      <h2 class="red-heading">See who's going</h2>
      <a class="connectFacebook" href="#"><img width="20px" alt="Facebook" src="~/Images/AMaterial/square-facebook.svg"> Connect with Facebook</a>
    </div>
  </div>
</section>
<!--****************************************************************************************************************************-->
<div ng-controller="ViewEventController" eventid="@Model.EventId.ToString()">
  <section class="grid w960">
    <div class="row">
      <div class="c12">
        <h2 class="red-heading">
          Choose tickets
          <span class="remain" ng-show="eventInfo.ShowRemainingTickets">
            ({{eventInfo.RemainingTickets}} remain)
          </span>
        </h2>

        <div class="ticket padding-1em-top padding-1em-bottom" ng-repeat="ticket in eventInfo.Tickets">
          <div class="c6 text24">{{ticket.TicketName}}</div>
          <div class="c3 text24 upp">
            {{ticket.TypeName}}
            <span class="smallFee" ng-show="((ticket.TicketTypeId == 2) && (ticket.ShowFee))">(+${{ticket.Fee.toFixed(2)}} FEE)</span>
          </div>
          <div class="c3 text-right">
            <md-input-container ng-show="((ticket.TicketTypeId != 3) && !ticket.SoldOut)">
              <label ng-show="false">Quantity</label>
              <md-select ng-model="ticket.Quantity" ng-change="onPriceChange()">
                <md-option ng-value="tq" ng-repeat="tq in ticket.Quants" ng-selected="tq == 0">{{ tq }}</md-option>
              </md-select>
            </md-input-container>
            <input type="number" class="inputbox wdt100 margin-1em-right" ng-model="ticket.Amount"
                   ng-change="onPriceChange()" ng-show="((ticket.TicketTypeId == 3) && !ticket.SoldOut)">
            <div class="c3 text24 upp" ng-show="(ticket.SoldOut)">
              Sold OUT
            </div>
          </div>
          <div class="c12">
            <span class="c3 padded ticdetail">{{ticket.VenueName}}</span>
            <span class="c3 padded ticdetail">{{ticket.StartDateFormatted}}</span>
          </div>
          <div class="c12 ticdes"><p>{{ticket.TicketDescription}}</p></div>
        </div>

        <div id="cartDeals">
          <div class="deal padding-1em-top padding-1em-bottom" ng-repeat="cartDeal in cartDeals">
            <img class="dealImg" ng-src="{{ cartDeal.dealimg }}">
            <div>
              <span class="dealOff">{{ cartDeal.dealoff }}</span>
              <span class="dealOffDetails">{{ cartDeal.dealdetails }}</span>
            </div>
            <div class="dealDes">
              <strong>{{ cartDeal.dealdesbold }}</strong> {{ cartDeal.dealdessmall }}<br>
              <a class="dealThumb"><i class="material-icons">thumb_up</i></a> {{ cartDeal.dealthumbsup }}
            </div>
            <div class="text-right">
              <a href="#" class="dealLink">Details</a>
              <a class="dealLink dark" ng-click="removeFormCart(cartDeal.dealid); cartDeals.splice($index, 1)">Remove from cart</a>
            </div>
          </div>
        </div>

        <div id="cartDealsMap">
          <div class="deal padding-1em-top padding-1em-bottom" ng-repeat="cartDealMap in cartDealsMap">
            <img class="dealImg" ng-src="{{ cartDealMap.dealimg }}">
            <div>
              <span class="dealOff">{{ cartDealMap.dealoff }}</span>
              <span class="dealOffDetails">{{ cartDealMap.dealdetails }}</span>
            </div>
            <div class="dealDes">
              <strong>{{ cartDealMap.dealdesbold }}</strong> {{ cartDealMap.dealdessmall }}<br>
              <a class="dealThumb"><i class="material-icons">thumb_up</i></a> {{ cartDealMap.dealthumbsup }}
            </div>
            <div class="text-right">
              <a href="#" class="dealLink">Details</a>
              <a class="dealLink dark" ng-click="cartDealsMap.splice($index, 1); id.splice($index, 1)">Remove from cart</a>
            </div>
          </div>
        </div>

      </div>
      <div class="c12 buttons text-right">
        <span class="tot text-right">Total: ${{eventInfo.TotalPrice.toFixed(2)}}</span>
      </div>
      <div class="c12 buttons text-right">
        <a href="#" class="makeLive">Checkout</a>
      </div>
    </div>
  </section>
  @Html.AntiForgeryToken()
  <!--****************************************************************************************************************************-->
  @if (false)
  {
    <section class="grid w960">
      <div class="row">
        <div class="c12">
          <h2 class="red-heading">Eventcombo Exclusive Deals</h2>
          <p class="bldtext">Buy together and save money! We have exclusive deals with retailers in the area to get you the best deal possible!</p>
          <div><a class="deal_btn margin-1em-top margin-2em-bottom" ng-click="dealBox = !dealBox"><i class="material-icons">format_list_bulleted</i>{{toggleText}} deals list</a></div>
          <div ng-show="dealBox">
            <div class="deal padding-1em-top padding-1em-bottom" ng-repeat="dealItem in dealsArray">
              <img class="dealImg" ng-src="{{ dealItem.dealimg }}">
              <div>
                <span class="dealOff">{{ dealItem.dealoff }}</span>
                <span class="dealOffDetails">{{ dealItem.dealdetails }}</span>
              </div>
              <div class="dealDes">
                <strong>{{ dealItem.dealdesbold }}</strong> {{ dealItem.dealdessmall }}<br>
                <a class="dealThumb"><i class="material-icons">thumb_up</i></a> {{ dealItem.dealthumbsup }}
              </div>
              <div class="text-right">
                <a href="#" class="dealLink">Details</a>
                <a class="dealLink dark" id="AddToCart" ng-click="addToCart(dealItem.dealid); dealsArray.splice($index, 1)"> Add to cart</a>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>
  }
  <!--****************************************************************************************************************************-->
  <section class="grid wfull margin-2em-top" id="mapView"></section>
  <div id="addDealMap"></div>
</div><!-- controller closed -->
